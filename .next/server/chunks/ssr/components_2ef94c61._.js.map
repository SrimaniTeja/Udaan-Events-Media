{"version":3,"sources":["../../../../components/upload/FileDropzone.tsx","../../../../components/event/EventStatusActionButton.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport type { FileType } from \"@/lib/types\";\r\nimport { cn } from \"@/lib/cn\";\r\nimport { Button } from \"@/components/ui/Button\";\r\n\r\nexport function FileDropzone({\r\n  eventId,\r\n  fileType,\r\n  label,\r\n}: {\r\n  eventId: string;\r\n  fileType: FileType;\r\n  label: string;\r\n}) {\r\n  const router = useRouter();\r\n  const inputRef = React.useRef<HTMLInputElement | null>(null);\r\n  const [busy, setBusy] = React.useState(false);\r\n  const [dragging, setDragging] = React.useState(false);\r\n  const [error, setError] = React.useState<string | null>(null);\r\n\r\n  async function upload(files: File[]) {\r\n    if (files.length === 0) return;\r\n    setBusy(true);\r\n    setError(null);\r\n\r\n    const form = new FormData();\r\n    for (const f of files) form.append(\"files\", f);\r\n\r\n    const res = await fetch(`/api/upload?eventId=${encodeURIComponent(eventId)}&fileType=${fileType}`, {\r\n      method: \"POST\",\r\n      body: form,\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const data = (await res.json().catch(() => null)) as any;\r\n      setError(data?.error ?? \"Upload failed\");\r\n      setBusy(false);\r\n      return;\r\n    }\r\n\r\n    setBusy(false);\r\n    router.refresh();\r\n  }\r\n\r\n  function onPick() {\r\n    inputRef.current?.click();\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid gap-3\">\r\n      <div\r\n        className={cn(\r\n          \"rounded-2xl border border-dashed border-border bg-surface/40 p-6 transition\",\r\n          dragging ? \"border-primary/60 bg-primary/10\" : \"hover:bg-surface/60\",\r\n        )}\r\n        onDragEnter={(e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          setDragging(true);\r\n        }}\r\n        onDragOver={(e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          setDragging(true);\r\n        }}\r\n        onDragLeave={(e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          setDragging(false);\r\n        }}\r\n        onDrop={(e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          setDragging(false);\r\n          void upload(Array.from(e.dataTransfer.files));\r\n        }}\r\n      >\r\n        <div className=\"flex flex-col items-start gap-2 sm:flex-row sm:items-center sm:justify-between\">\r\n          <div>\r\n            <div className=\"text-sm font-medium\">{label}</div>\r\n            <div className=\"mt-1 text-xs text-muted-foreground\">\r\n              Drag & drop files here, or choose from your device. (Drive upload streaming will be added next.)\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Button type=\"button\" variant=\"secondary\" onClick={onPick} disabled={busy}>\r\n              Choose files\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <input\r\n          ref={inputRef}\r\n          className=\"hidden\"\r\n          type=\"file\"\r\n          multiple\r\n          onChange={(e) => void upload(Array.from(e.target.files ?? []))}\r\n        />\r\n      </div>\r\n\r\n      {error ? (\r\n        <div className=\"rounded-xl border border-warning/30 bg-warning/10 px-3 py-2 text-sm text-warning\">\r\n          {error}\r\n        </div>\r\n      ) : null}\r\n      {busy ? <div className=\"text-xs text-muted-foreground\">Uploading…</div> : null}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n","\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport type { EventStatus } from \"@/lib/types\";\r\nimport { Button } from \"@/components/ui/Button\";\r\n\r\nexport function EventStatusActionButton({\r\n  eventId,\r\n  nextStatus,\r\n  children,\r\n  variant = \"primary\",\r\n}: {\r\n  eventId: string;\r\n  nextStatus: EventStatus;\r\n  children: React.ReactNode;\r\n  variant?: \"primary\" | \"secondary\" | \"ghost\";\r\n}) {\r\n  const router = useRouter();\r\n  const [busy, setBusy] = React.useState(false);\r\n\r\n  async function run() {\r\n    setBusy(true);\r\n    await fetch(`/api/events/${encodeURIComponent(eventId)}`, {\r\n      method: \"PATCH\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ nextStatus }),\r\n    });\r\n    setBusy(false);\r\n    router.refresh();\r\n  }\r\n\r\n  return (\r\n    <Button onClick={run} disabled={busy} variant={variant}>\r\n      {busy ? \"Working…\" : children}\r\n    </Button>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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"}